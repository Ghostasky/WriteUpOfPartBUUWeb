[toc]



# ä»£ç å®¡è®¡

## ç›®å½•

### ç®€å•

-   [HCTF 2018] WarmUp éš¾åº¦ï¼šç®€å• çŸ¥è¯†ç‚¹ï¼šåˆæ­¥çš„ä»£ç å®¡è®¡å’Œæ–‡ä»¶åŒ…å«
-   [BJDCTF2020]Mark loves cat ç®€å•çš„ä»£ç å®¡è®¡ï¼Œå˜é‡è¦†ç›–

### ç­¾åˆ°

-   [HCTF 2018]admin ä¸­ç­‰éš¾åº¦çš„é¢˜ç›®ï¼Œè§£æ³•è¾ƒå¤šï¼Œåˆ†åˆ«æœ‰jwtä¼ªé€ ï¼Œæ¡ä»¶ç«äº‰å’Œunicodeæ¬ºéª—
-   [ZJCTF 2019]NiZhuanSiWe åŸºç¡€çš„ä»£ç å®¡è®¡ï¼Œè§£æ³•è¾ƒå¤šï¼Œphpä¼ªåè®®
-   [BJDCTF2020]EasySearch é™¤äº†æ³¨å…¥ä»¥å¤–è¿˜ä¼šæœ‰Apache SSI è¿œç¨‹å‘½ä»¤æ‰§è¡Œæ¼æ´
-   [HarekazeCTF2019]encode_and_encode ç¼–ç ç»•è¿‡
-   [SUCTF 2019]EasyWeb å½“å¹´æ¯”è¾ƒéš¾çš„é¢˜ç›®ï¼Œç°åœ¨è¿™äº›è€ƒç‚¹è¢«å¹²ç¢äº†å†å‡ºç°å°±åªèƒ½åšç­¾åˆ°äº†
-   [å®‰æ´µæ¯ 2019]ä¸æ˜¯æ–‡ä»¶ä¸Šä¼  ä»‹ä¹äºç­¾åˆ°å’Œä¸­ç­‰ä¹‹é—´ï¼Œå¤šä¸ªè€ƒç‚¹é‡åˆåœ¨ä¸€èµ·äº†
-   [N1CTF 2018]eating_cms
-   [PASECA2019] honey_shop è¯»å–ç¯å¢ƒå˜é‡ï¼Œä»‹ä¹äºç­¾åˆ°å’Œä¸­ç­‰ä¹‹é—´
-   Phuck2
-   [ç½‘é¼æ¯ 2020 æ€»å†³èµ›]Game Exp
-   

### ä¸­ç­‰

-   [De1CTF 2019]SSRF Me Flask å­—ç¬¦ä¸²æ‹¼æ¥å¸¦æ¥çš„å®‰å…¨é—®é¢˜
-   [HFCTF2020]EasyLogin jwtä¼ªé€ 
-   [SCTF2019]Flag Shop ruby ä»£ç å®¡è®¡
-   [DDCTF 2019]homebrew event loop é€»è¾‘æ¼æ´
-   [XDCTF 2015]filemanager
-   [PwnThyBytes 2019]Baby_SQL
-   [SWPUCTF 2016]Web blogsys å“ˆå¸Œæ‹“å±•æ”»å‡»ï¼Œé€»è¾‘æ¼æ´
-   [PWNHUB å…¬å¼€èµ› 2018]å‚» fufu çš„å·¥ä½œæ—¥ åŠ è§£å¯†é€»è¾‘æœ€å¥½è‡ªå·±èƒ½å¤ŸæŒæ¡ã€‚
-   [CISCN2019 ä¸œåŒ—èµ›åŒº Day2 Web3]Point System
-   [HBCTF2017]å¤§ç¾è¥¿å®‰
-   [N1CTF 2018]easy_harder_php soap_ssrf éå¸¸ç»å…¸çš„é¢˜ç›®
-   [Zer0pts2020]notepad pythonååºåˆ—åŒ–

### å›°éš¾

-   [ç½‘é¼æ¯ 2020 åŠå†³èµ›]faka ä¸­ç­‰åéš¾
-   [RoarCTF 2019]PHPShe
-   [æŠ¤ç½‘æ¯ 2018]easy_laravel
-   [HMBCTF 2021]EzLight çº¢å¸½æ¯å°±3è§£è¿˜æ˜¯å‡ è§£æˆ‘è®°å¾—ã€‚
-   [HITCON 2017]Baby^h Master PHP Apache-preforkæ¨¡å‹(é»˜è®¤æ¨¡å‹)åœ¨æ¥å—è¯·æ±‚åä¼šå¦‚ä½•å¤„ç†,é¦–å…ˆApacheä¼šé»˜è®¤ç”Ÿæˆ5ä¸ªchild serverå»ç­‰å¾…ç”¨æˆ·è¿æ¥, é»˜è®¤æœ€é«˜å¯ç”Ÿæˆ256ä¸ªchild server, è¿™æ—¶å€™å¦‚æœç”¨æˆ·å¤§é‡è¯·æ±‚, Apacheå°±ä¼šåœ¨å¤„ç†å®ŒMaxRequestsPerChildä¸ªtcpè¿æ¥åkillæ‰è¿™ä¸ªè¿›ç¨‹,å¼€å¯ä¸€ä¸ªæ–°è¿›ç¨‹å¤„ç†è¯·æ±‚
-   [CISCN2019 æ€»å†³èµ› Day2 Web2]Laravel File Manager å‚è€ƒæ–‡ç« ï¼šhttps://blog.szfszf.top/article/39/ ä¹Ÿæ˜¯å›½èµ›ç»å…¸ä¸è®©äººåš
-   Real World CTF 2018 Bookhub



### è„‘æ´

-   [ç¾ŠåŸæ¯ 2020]Blackcat è¦å¬æ­Œçš„WEBé¢˜ç›®== 2020ğŸåŸæ¯çš„é¢˜ç›®æ„Ÿè§‰..

## Writeup

### [HCTF 2018] WarmUp

æç¤ºsource.php

```php
<?php
    highlight_file(__FILE__);
    class emmm
    {
        public static function checkFile(&$page)
        {
            $whitelist = ["source"=>"source.php","hint"=>"hint.php"];
            if (! isset($page) || !is_string($page)) {
                echo "you can't see it";
                return false;
            }

            if (in_array($page, $whitelist)) {
                return true;
            }

            $_page = mb_substr(
                $page,
                0,
                mb_strpos($page . '?', '?')
            );
            if (in_array($_page, $whitelist)) {
                return true;
            }

            $_page = urldecode($page);
            $_page = mb_substr(
                $_page,
                0,
                mb_strpos($_page . '?', '?')
            );
            if (in_array($_page, $whitelist)) {
                return true;
            }
            echo "you can't see it";
            return false;
        }
    }

    if (! empty($_REQUEST['file'])
        && is_string($_REQUEST['file'])
        && emmm::checkFile($_REQUEST['file'])
    ) {
        include $_REQUEST['file'];
        exit;
    } else {
        echo "<br><img src=\"https://i.loli.net/2018/11/01/5bdb0d93dc794.jpg\" />";
    }  
?>
```

æ¥æ”¶fileï¼Œä¸ä¸ºç©ºï¼Œæ˜¯å­—ç¬¦ä¸²ï¼Œæ»¡è¶³emmm::checkFile

flagåœ¨ffffllllaaaagggg